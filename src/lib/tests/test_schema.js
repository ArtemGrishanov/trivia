import { Selector } from '../object-path.js'
import DataSchema from '../schema.js'

describe('Schema', function () {
    describe('#getDescription', function () {
        it('schema.getDescription() performance', function () {
            // standart trivia app schema
            // not final, snapshot 10.11.2019
            const schema = new DataSchema(
                JSON.parse(`{"app.size.width":{"type":"number","min":80,"max":4000,"default":444,"appWidthProperty":true},"app.size.height":{"type":"number","min":18,"max":12000,"default":444,"appHeightProperty":true},"router.[screens HashList]":{"type":"hashlist","default":{"_orderedIds":[]},"minLength":0,"maxLength":32,"prototypes":[{"id":"default_prototype","data":{"displayName":"Screen","backgroundColor":"green"}}]},"router.currentScreenId":{"type":"string","default":null},"router.displayMode":{"type":"string","enum":["oneScreen","verticalAll"],"default":"oneScreen"},"router.backgroundColor":{"type":"string","default":""},"router.switchEffect":{"type":"string","enum":["none"],"default":"none"},"router.[screens HashList]./^[0-9a-z]+$/.backgroundColor":{"type":"string","default":""},"router.[screens HashList]./^[0-9a-z]+$/.components":{"type":"hashlist","minLength":0,"maxLength":128,"default":{"_orderedIds":[]},"prototypes":[{"id":"dumb_component","data":{"displayName":"Element","backgroundColor":"#fff"}}]},"router.[screens HashList]./^[0-9a-z]+$/.tags":{"type":"string","minLength":0,"maxLength":1024,"default":"remixcomponent"},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Text].text":{"type":"string","minLength":1,"maxLength":1024,"default":"Some text"},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Text].fontSize":{"type":"number","min":8,"max":80,"default":14},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Text].color":{"type":"string","default":"#333"},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Text].backgroundColor":{"type":"string","default":""},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Text].padding":{"type":"number","min":0,"max":100,"default":0},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Text].fontShadow":{"type":"boolean","default":false,"enum":["false","true"]},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Text].fontShadowColor":{"type":"string","default":"rgba(0,0,0,0.2)"},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Text].fontShadowDistance":{"type":"number","default":3,"min":0,"max":100},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Text].bold":{"type":"boolean","default":false,"enum":["false","true"]},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Text].animationOnAppearance":{"type":"string","enum":["none","typing"],"default":"none"},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Text].id":{"type":"string","minLength":4,
                "maxLength":1024,"default":"none"},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Text].tags":{"type":"string","minLength":0,"maxLength":1024,"default":"remixcomponent"},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Text].displayName":{"type":"string","minLength":1,"default":"Text"},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Text].width":{"type":"number","min":1,"max":100,"default":30},
                "router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Text].height":{"type":"number","min":1,"max":100,"default":30},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Text].left":{"type":"number","min":-50,"max":150,"default":11},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Text].top":{"type":"number","min":-100,"max":3000,"default":11},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Progress].step":{"type":"number","min":1,"max":1000,"default":1},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Progress].max":{"type":"number","min":1,"max":1000,"default":10},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Progress].fontSize":{"type":"number","min":8,"max":80,"default":14},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Progress].color":{"type":"string","default":"#333"},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Progress].id":{"type":"string","minLength":4,"maxLength":1024,"default":"none"},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Progress].tags":{"type":"string","minLength":0,"maxLength":1024,"default":"remixcomponent"},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Progress].displayName":{"type":"string","minLength":1,"default":"Progress"},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Progress].width":{"type":"number","min":1,"max":100,"default":30},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Progress].height":{"type":"number","min":1,"max":100,"default":30},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Progress].left":{"type":"number","min":-50,"max":150,"default":11},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Progress].top":{"type":"number","min":-100,"max":3000,"default":11},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=TextOption].text":{"type":"string","minLength":1,"maxLength":1000,"default":"input text"},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=TextOption].correctIndicator":{"type":"string","enum":["none","empty","correct","wrong","wrong_gray"],"default":"none"},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=TextOption].percent":{"type":"number","min":0,"max":100,"default":0},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=TextOption].textAlign":{"type":"string","enum":["left","center","right"],"default":"left"},
                "router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=TextOption].borderRadius":{"type":"number","min":0,"max":100,"default":4},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=TextOption].id":{"type":"string","minLength":4,"maxLength":1024,"default":"none"},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=TextOption].tags":{"type":"string","minLength":0,"maxLength":1024,"default":"remixcomponent"},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=TextOption].displayName":{"type":"string","minLength":1,"default":"TextOption"},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=TextOption].width":{"type":"number","min":1,"max":100,"default":30},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=TextOption].height":{"type":"number","min":1,"max":100,"default":30},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=TextOption].left":{"type":"number","min":-50,"max":150,"default":11},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=TextOption].top":{"type":"number","min":-100,"max":3000,"default":11},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Button].text":{"type":"string","minLength":1,"maxLength":128,"default":"Button text"},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Button].sizeMod":{"type":"string","enum":["small","normal"],"default":"normal"},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Button].colorMod":{"type":"string","enum":["blue","white"],"default":"blue"},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Button].id":{"type":"string","minLength":4,"maxLength":1024,"default":"none"},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Button].tags":{"type":"string","minLength":0,"maxLength":1024,"default":"remixcomponent"},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Button].displayName":{"type":"string","minLength":1,"default":"Button"},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Button].width":{"type":"number","min":1,"max":100,"default":30},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Button].height":{"type":"number","min":1,"max":100,"default":30},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Button].left":{"type":"number","min":-50,"max":150,"default":11},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=Button].top":{"type":"number","min":-100,"max":3000,"default":11},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=FbButton].shareText":{"type":"string","minLength":1,
                "maxLength":128,"default":"Share"},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=FbButton].sizeMod":{"type":"string","enum":["circle","normal"],"default":"normal"},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=FbButton].id":{"type":"string","minLength":4,"maxLength":1024,"default":"none"},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=FbButton].tags":{"type":"string","minLength":0,"maxLength":1024,"default":"remixcomponent"},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=FbButton].displayName":{"type":"string","minLength":1,"default":"FbButton"},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=FbButton].width":{"type":"number","min":1,"max":100,"default":30},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=FbButton].height":{"type":"number","min":1,"max":100,"default":30},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=FbButton].left":{"type":"number","min":-50,"max":150,"default":11},"router.[screens HashList]./^[0-9a-z]+$/.components.[/^[0-9a-z]+$/ displayName=FbButton].top":{"type":"number","min":-100,"max":3000,"default":11}}`),
            )

            // 195 pathes from state, from Trivia project
            // not final, snapshot 10.11.2019
            const pathesArr = JSON.parse(`["router.screens","router.currentScreenId","router.displayMode","router.backgroundColor","router.switchEffect","app.size.width","app.size.height","router.screens.z6z9sh.backgroundColor","router.screens.8wruuz.backgroundColor","router.screens.nch4zc.backgroundColor","router.screens.f5n509.backgroundColor","router.screens.z6z9sh.components","router.screens.8wruuz.components","router.screens.nch4zc.components","router.screens.f5n509.components","router.screens.z6z9sh.tags","router.screens.8wruuz.tags","router.screens.nch4zc.tags","router.screens.f5n509.tags","router.screens.z6z9sh.components.emeh5f.text","router.screens.8wruuz.components.zbnkhy.text","router.screens.nch4zc.components.tqsfr9.text","router.screens.f5n509.components.bxeyfi.text","router.screens.z6z9sh.components.emeh5f.fontSize","router.screens.8wruuz.components.zbnkhy.fontSize","router.screens.nch4zc.components.tqsfr9.fontSize","router.screens.f5n509.components.bxeyfi.fontSize","router.screens.z6z9sh.components.emeh5f.color","router.screens.8wruuz.components.zbnkhy.color","router.screens.nch4zc.components.tqsfr9.color","router.screens.f5n509.components.bxeyfi.color","router.screens.z6z9sh.components.emeh5f.backgroundColor","router.screens.8wruuz.components.zbnkhy.backgroundColor","router.screens.nch4zc.components.tqsfr9.backgroundColor","router.screens.f5n509.components.bxeyfi.backgroundColor","router.screens.z6z9sh.components.emeh5f.padding","router.screens.8wruuz.components.zbnkhy.padding","router.screens.nch4zc.components.tqsfr9.padding","router.screens.f5n509.components.bxeyfi.padding","router.screens.z6z9sh.components.emeh5f.fontShadow","router.screens.8wruuz.components.zbnkhy.fontShadow","router.screens.nch4zc.components.tqsfr9.fontShadow","router.screens.f5n509.components.bxeyfi.fontShadow","router.screens.z6z9sh.components.emeh5f.fontShadowColor","router.screens.8wruuz.components.zbnkhy.fontShadowColor","router.screens.nch4zc.components.tqsfr9.fontShadowColor","router.screens.f5n509.components.bxeyfi.fontShadowColor","router.screens.z6z9sh.components.emeh5f.fontShadowDistance","router.screens.8wruuz.components.zbnkhy.fontShadowDistance","router.screens.nch4zc.components.tqsfr9.fontShadowDistance","router.screens.f5n509.components.bxeyfi.fontShadowDistance","router.screens.z6z9sh.components.emeh5f.bold","router.screens.8wruuz.components.zbnkhy.bold","router.screens.nch4zc.components.tqsfr9.bold","router.screens.f5n509.components.bxeyfi.bold","router.screens.z6z9sh.components.emeh5f.animationOnAppearance","router.screens.8wruuz.components.zbnkhy.animationOnAppearance","router.screens.nch4zc.components.tqsfr9.animationOnAppearance","router.screens.f5n509.components.bxeyfi.animationOnAppearance","router.screens.z6z9sh.components.emeh5f.id","router.screens.8wruuz.components.zbnkhy.id","router.screens.nch4zc.components.tqsfr9.id","router.screens.f5n509.components.bxeyfi.id","router.screens.z6z9sh.components.emeh5f.tags","router.screens.8wruuz.components.zbnkhy.tags","router.screens.nch4zc.components.tqsfr9.tags","router.screens.f5n509.components.bxeyfi.tags","router.screens.z6z9sh.components.emeh5f.displayName","router.screens.8wruuz.components.zbnkhy.displayName","router.screens.nch4zc.components.tqsfr9.displayName","router.screens.f5n509.components.bxeyfi.displayName","router.screens.z6z9sh.components.emeh5f.width","router.screens.8wruuz.components.zbnkhy.width","router.screens.nch4zc.components.tqsfr9.width","router.screens.f5n509.components.bxeyfi.width","router.screens.z6z9sh.components.emeh5f.height","router.screens.8wruuz.components.zbnkhy.height","router.screens.nch4zc.components.tqsfr9.height","router.screens.f5n509.components.bxeyfi.height","router.screens.z6z9sh.components.emeh5f.left","router.screens.8wruuz.components.zbnkhy.left","router.screens.nch4zc.components.tqsfr9.left","router.screens.f5n509.components.bxeyfi.left","router.screens.z6z9sh.components.emeh5f.top","router.screens.8wruuz.components.zbnkhy.top","router.screens.nch4zc.components.tqsfr9.top","router.screens.f5n509.components.bxeyfi.top","router.screens.z6z9sh.components.b7nyif.step","router.screens.8wruuz.components.0nej9q.step","router.screens.z6z9sh.components.b7nyif.max","router.screens.8wruuz.components.0nej9q.max","router.screens.z6z9sh.components.b7nyif.fontSize","router.screens.8wruuz.components.0nej9q.fontSize","router.screens.z6z9sh.components.b7nyif.color","router.screens.8wruuz.components.0nej9q.color","router.screens.z6z9sh.components.b7nyif.id","router.screens.8wruuz.components.0nej9q.id","router.screens.z6z9sh.components.b7nyif.tags","router.screens.8wruuz.components.0nej9q.tags","router.screens.z6z9sh.components.b7nyif.displayName",
                "router.screens.8wruuz.components.0nej9q.displayName","router.screens.z6z9sh.components.b7nyif.width","router.screens.8wruuz.components.0nej9q.width","router.screens.z6z9sh.components.b7nyif.height","router.screens.8wruuz.components.0nej9q.height","router.screens.z6z9sh.components.b7nyif.left","router.screens.8wruuz.components.0nej9q.left","router.screens.z6z9sh.components.b7nyif.top","router.screens.8wruuz.components.0nej9q.top","router.screens.z6z9sh.components.fkrwjx.text","router.screens.z6z9sh.components.pkbeyp.text","router.screens.8wruuz.components.sp2hjp.text","router.screens.8wruuz.components.7l5bp4.text","router.screens.z6z9sh.components.fkrwjx.correctIndicator","router.screens.z6z9sh.components.pkbeyp.correctIndicator","router.screens.8wruuz.components.sp2hjp.correctIndicator","router.screens.8wruuz.components.7l5bp4.correctIndicator","router.screens.z6z9sh.components.fkrwjx.percent","router.screens.z6z9sh.components.pkbeyp.percent","router.screens.8wruuz.components.sp2hjp.percent","router.screens.8wruuz.components.7l5bp4.percent","router.screens.z6z9sh.components.fkrwjx.textAlign","router.screens.z6z9sh.components.pkbeyp.textAlign","router.screens.8wruuz.components.sp2hjp.textAlign","router.screens.8wruuz.components.7l5bp4.textAlign","router.screens.z6z9sh.components.fkrwjx.borderRadius","router.screens.z6z9sh.components.pkbeyp.borderRadius","router.screens.8wruuz.components.sp2hjp.borderRadius","router.screens.8wruuz.components.7l5bp4.borderRadius","router.screens.z6z9sh.components.fkrwjx.id","router.screens.z6z9sh.components.pkbeyp.id","router.screens.8wruuz.components.sp2hjp.id","router.screens.8wruuz.components.7l5bp4.id","router.screens.z6z9sh.components.fkrwjx.tags","router.screens.z6z9sh.components.pkbeyp.tags","router.screens.8wruuz.components.sp2hjp.tags","router.screens.8wruuz.components.7l5bp4.tags","router.screens.z6z9sh.components.fkrwjx.displayName","router.screens.z6z9sh.components.pkbeyp.displayName","router.screens.8wruuz.components.sp2hjp.displayName","router.screens.8wruuz.components.7l5bp4.displayName","router.screens.z6z9sh.components.fkrwjx.width","router.screens.z6z9sh.components.pkbeyp.width","router.screens.8wruuz.components.sp2hjp.width","router.screens.8wruuz.components.7l5bp4.width","router.screens.z6z9sh.components.fkrwjx.height","router.screens.z6z9sh.components.pkbeyp.height","router.screens.8wruuz.components.sp2hjp.height","router.screens.8wruuz.components.7l5bp4.height","router.screens.z6z9sh.components.fkrwjx.left","router.screens.z6z9sh.components.pkbeyp.left","router.screens.8wruuz.components.sp2hjp.left","router.screens.8wruuz.components.7l5bp4.left","router.screens.z6z9sh.components.fkrwjx.top","router.screens.z6z9sh.components.pkbeyp.top","router.screens.8wruuz.components.sp2hjp.top","router.screens.8wruuz.components.7l5bp4.top","router.screens.nch4zc.components.py6c0w.text","router.screens.f5n509.components.rtfms8.text","router.screens.nch4zc.components.py6c0w.sizeMod","router.screens.f5n509.components.rtfms8.sizeMod","router.screens.nch4zc.components.py6c0w.colorMod","router.screens.f5n509.components.rtfms8.colorMod","router.screens.nch4zc.components.py6c0w.id","router.screens.f5n509.components.rtfms8.id","router.screens.nch4zc.components.py6c0w.tags","router.screens.f5n509.components.rtfms8.tags","router.screens.nch4zc.components.py6c0w.displayName","router.screens.f5n509.components.rtfms8.displayName","router.screens.nch4zc.components.py6c0w.width","router.screens.f5n509.components.rtfms8.width","router.screens.nch4zc.components.py6c0w.height","router.screens.f5n509.components.rtfms8.height","router.screens.nch4zc.components.py6c0w.left","router.screens.f5n509.components.rtfms8.left","router.screens.nch4zc.components.py6c0w.top","router.screens.f5n509.components.rtfms8.top","router.screens.nch4zc.components.qtrvbq.shareText","router.screens.f5n509.components.pq94on.shareText","router.screens.nch4zc.components.qtrvbq.sizeMod","router.screens.f5n509.components.pq94on.sizeMod","router.screens.nch4zc.components.qtrvbq.id","router.screens.f5n509.components.pq94on.id","router.screens.nch4zc.components.qtrvbq.tags","router.screens.f5n509.components.pq94on.tags","router.screens.nch4zc.components.qtrvbq.displayName","router.screens.f5n509.components.pq94on.displayName","router.screens.nch4zc.components.qtrvbq.width","router.screens.f5n509.components.pq94on.width","router.screens.nch4zc.components.qtrvbq.height","router.screens.f5n509.components.pq94on.height","router.screens.nch4zc.components.qtrvbq.left","router.screens.f5n509.components.pq94on.left","router.screens.nch4zc.components.qtrvbq.top","router.screens.f5n509.components.pq94on.top"]`)

            for (let i = 0; i < 10; i++) {
                // this is a fragment from remix._doUpdate inner method
                // performance testing
                pathesArr.forEach(path => {
                    const propDescription = schema.getDescription(path)
                    if (!propDescription) {
                        throw new Error(`Remix: can not find description for path "${path}" in schema`)
                    }
                })
            }

            // 1st run 10.11.2019 3:17pm MSK = 1500ms
            // 2nd run 10.11.2019 5:36pm MSK = 170ms (schema _selectorForPathCache applied)

            chai.assert.equal(true, true)
        })
    })
})
